"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var buttonModule = require("ui/button");
var RockModel_1 = require("./RockModel");
var RockUser = (function () {
    function RockUser(page, id) {
        this.imgUrl = '';
        this.imgUrls = ['~/images/scssors.png', '~/images/rock.png', '~/images/paper.png'];
        this.imgNum = 0;
        this.isWinner = -1;
        this.user = page.getViewById(id);
        this.imgUrl = this.imgUrls[0];
        this.startRolling();
        this.eventsetting();
    }
    RockUser.prototype.eventsetting = function () {
        var _this = this;
        this.user.on(buttonModule.Button.tapEvent, function () {
            clearInterval(_this.timer);
            _this.select();
        });
    };
    RockUser.prototype.select = function () {
        this.user.off(buttonModule.Button.tapEvent);
        var selectedNum = RockModel_1.getSelected();
        var num;
        if (this.isWinner > -1 && selectedNum > -1) {
            num = (selectedNum + (this.isWinner === 1 ? 1 : 2)) % 3;
        }
        else {
            num = Math.floor(Math.random() * this.imgUrls.length);
        }
        this.user.src = this.imgUrls[num];
        RockModel_1.setSelected(num);
    };
    RockUser.prototype.setWinner = function (isWinner) {
        this.isWinner = isWinner;
    };
    RockUser.prototype.startRolling = function () {
        var _this = this;
        this.timer = setInterval(function () {
            _this.imgNum = (_this.imgNum + 1) % 3;
            _this.user.src = _this.imgUrls[_this.imgNum];
            if (_this.imgNum === 2) {
                _this.user.width = '40%';
            }
            else {
                _this.user.width = '35%';
            }
        }, 100);
    };
    RockUser.prototype.reset = function () {
        clearInterval(this.timer);
        this.startRolling();
        this.eventsetting();
    };
    return RockUser;
}());
exports.default = RockUser;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUm9ja1VzZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJSb2NrVXNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHdDQUEyQztBQUMzQyx5Q0FBcUQ7QUFFckQ7SUFTSSxrQkFBWSxJQUFJLEVBQUUsRUFBRTtRQU5aLFdBQU0sR0FBVyxFQUFFLENBQUM7UUFDcEIsWUFBTyxHQUFrQixDQUFDLHNCQUFzQixFQUFFLG1CQUFtQixFQUFFLG9CQUFvQixDQUFDLENBQUM7UUFFN0YsV0FBTSxHQUFXLENBQUMsQ0FBQztRQUNuQixhQUFRLEdBQVcsQ0FBQyxDQUFDLENBQUM7UUFHMUIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRWpDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM5QixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFFRCwrQkFBWSxHQUFaO1FBQUEsaUJBS0M7UUFKRyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRTtZQUN2QyxhQUFhLENBQUMsS0FBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzFCLEtBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNsQixDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFFRCx5QkFBTSxHQUFOO1FBQ0ksSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM1QyxJQUFNLFdBQVcsR0FBRyx1QkFBVyxFQUFFLENBQUM7UUFDbEMsSUFBSSxHQUFXLENBQUM7UUFFaEIsRUFBRSxDQUFBLENBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsSUFBSSxXQUFXLEdBQUcsQ0FBQyxDQUFFLENBQUMsQ0FBQSxDQUFDO1lBQ3pDLEdBQUcsR0FBRyxDQUFDLFdBQVcsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFDLENBQUMsQ0FBQztRQUMxRCxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxRCxDQUFDO1FBRUQsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNsQyx1QkFBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRXJCLENBQUM7SUFFRCw0QkFBUyxHQUFULFVBQVUsUUFBUTtRQUNkLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0lBQzdCLENBQUM7SUFFRCwrQkFBWSxHQUFaO1FBQUEsaUJBVUM7UUFURyxJQUFJLENBQUMsS0FBSyxHQUFHLFdBQVcsQ0FBQztZQUNyQixLQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsS0FBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDcEMsS0FBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsS0FBSSxDQUFDLE9BQU8sQ0FBQyxLQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDMUMsRUFBRSxDQUFDLENBQUMsS0FBSSxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNwQixLQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7WUFDNUIsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLEtBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztZQUM1QixDQUFDO1FBQ0wsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ1osQ0FBQztJQUVELHdCQUFLLEdBQUw7UUFDSSxhQUFhLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzFCLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUNMLGVBQUM7QUFBRCxDQUFDLEFBN0RELElBNkRDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJ1dHRvbk1vZHVsZSA9IHJlcXVpcmUoXCJ1aS9idXR0b25cIik7XG5pbXBvcnQge3NldFNlbGVjdGVkLCBnZXRTZWxlY3RlZH0gZnJvbSAnLi9Sb2NrTW9kZWwnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb2NrVXNlciB7XG5cbiAgICBwcml2YXRlIHVzZXI7XG4gICAgcHJpdmF0ZSBpbWdVcmw6IHN0cmluZyA9ICcnO1xuICAgIHByaXZhdGUgaW1nVXJsczogQXJyYXk8c3RyaW5nPiA9IFsnfi9pbWFnZXMvc2Nzc29ycy5wbmcnLCAnfi9pbWFnZXMvcm9jay5wbmcnLCAnfi9pbWFnZXMvcGFwZXIucG5nJ107XG4gICAgcHJpdmF0ZSB0aW1lcjtcbiAgICBwcml2YXRlIGltZ051bTogbnVtYmVyID0gMDtcbiAgICBwcml2YXRlIGlzV2lubmVyOiBudW1iZXIgPSAtMTtcblxuICAgIGNvbnN0cnVjdG9yKHBhZ2UsIGlkKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHBhZ2UuZ2V0Vmlld0J5SWQoaWQpO1xuXG4gICAgICAgIHRoaXMuaW1nVXJsID0gdGhpcy5pbWdVcmxzWzBdO1xuICAgICAgICB0aGlzLnN0YXJ0Um9sbGluZygpO1xuICAgICAgICB0aGlzLmV2ZW50c2V0dGluZygpO1xuICAgIH1cblxuICAgIGV2ZW50c2V0dGluZygpIHtcbiAgICAgICAgdGhpcy51c2VyLm9uKGJ1dHRvbk1vZHVsZS5CdXR0b24udGFwRXZlbnQsICgpID0+IHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdCgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHNlbGVjdCgpIHtcbiAgICAgICAgdGhpcy51c2VyLm9mZihidXR0b25Nb2R1bGUuQnV0dG9uLnRhcEV2ZW50KTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWROdW0gPSBnZXRTZWxlY3RlZCgpO1xuICAgICAgICBsZXQgbnVtOiBudW1iZXI7XG5cbiAgICAgICAgaWYoIHRoaXMuaXNXaW5uZXIgPiAtMSAmJiBzZWxlY3RlZE51bSA+IC0xICl7XG4gICAgICAgICAgICBudW0gPSAoc2VsZWN0ZWROdW0gKyAodGhpcy5pc1dpbm5lciA9PT0gMSA/IDEgOiAyKSklMztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG51bSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuaW1nVXJscy5sZW5ndGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51c2VyLnNyYyA9IHRoaXMuaW1nVXJsc1tudW1dO1xuICAgICAgICBzZXRTZWxlY3RlZChudW0pO1xuXG4gICAgfVxuXG4gICAgc2V0V2lubmVyKGlzV2lubmVyKSB7XG4gICAgICAgIHRoaXMuaXNXaW5uZXIgPSBpc1dpbm5lcjtcbiAgICB9XG5cbiAgICBzdGFydFJvbGxpbmcoKSB7XG4gICAgICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmltZ051bSA9ICh0aGlzLmltZ051bSArIDEpICUgMztcbiAgICAgICAgICAgIHRoaXMudXNlci5zcmMgPSB0aGlzLmltZ1VybHNbdGhpcy5pbWdOdW1dO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW1nTnVtID09PSAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51c2VyLndpZHRoID0gJzQwJSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudXNlci53aWR0aCA9ICczNSUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAxMDApO1xuICAgIH1cblxuICAgIHJlc2V0KCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpO1xuICAgICAgICB0aGlzLnN0YXJ0Um9sbGluZygpO1xuICAgICAgICB0aGlzLmV2ZW50c2V0dGluZygpO1xuICAgIH1cbn0iXX0=